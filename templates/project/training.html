{% extends 'project/base.html' %}

{% load static %}

{% block css_block %}
<link rel="stylesheet" href="{% static 'css/project/training.css' %}"/>
{% endblock css_block %}

{% block js_block %}
<script type="text/javascript" src="{% static 'js/project/plotly-latest.min.js' %}"></script>
<script type="text/javascript" src="{% static 'js/project/training.js' %}"></script>
{% endblock js_block %}

{% block content_block %}

<div class="toolbar project-training-toolbar">
    <div class="wrapper">
        <ul class="menu-section">
            <li data-type="charts">
                <span><img src="{% static 'imgs/model-menu-1.svg' %}" alt="" /></span>
            </li>
            <li data-type="images">
                <span><img src="{% static 'imgs/model-menu-2.svg' %}" alt="" /></span>
            </li>
            <li data-type="texts">
                <span><img src="{% static 'imgs/validation.svg' %}" alt="" /></span>
            </li>
            <li data-type="scatters">
                <span><img src="{% static 'imgs/validation.svg' %}" alt="" /></span>
            </li>
        </ul>
    </div>
</div>

<div class="board">
    <div class="graphics">
        <div class="wrapper">
            <div class="tabs-content">
                <div class="inner">
                    <div class="tabs-item graphics custom-scrollbar-wrapper">
                        <div class="tab-container">
                            <div class="charts">
                                <div class="category-title">Графики</div>
                                <div class="content"></div>
                            </div>
                            <div class="images">
                                <div class="category-title">Картинки</div>
                                <div class="content"></div>
                            </div>
                            <div class="texts">
                                <div class="category-title">Текст</div>
                                <div class="content"></div>
                            </div>
                            <div class="scatters">
                                <div class="category-title">Скаттеры</div>
                                <div class="content"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="training-progress custom-scrollbar-wrapper">
        <div class="info"></div>
    </div>
</div>

<div class="properties project-training-properties">
    <div class="wrapper">
        <div class="params">
            <form class="params-container" novalidate="novalidate" autocomplete="off">
                <div class="params-item">
                    <div class="inner settings custom-scrollbar-wrapper">
                        <div class="params-item params-optimizer">
                            <div class="inner">
                                <div class="field-form field-inline">
                                    <label for="field_form-optimazer">Оптимизатор</label>
                                    <select id="field_form-optimazer" name="optimazer[name]" class="jquery-ui-menuselect">
                                        {% for name in request.terra_project.optimizers %}
                                            <option value="{{ name }}"{% if name == request.terra_project.training.optimizer.name %} selected="selected"{% endif %}>{{ name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="field-form form-inline-label">
                                    <div class="field-form field-inline">
                                        <label for="field_form-batch_sizes">Размер батча</label>
                                        <input name="batch_sizes" id="field_form-batch_sizes" type="number" value="{{ request.terra_project.training.batch_sizes }}" />
                                    </div>
                                    <div class="field-form field-inline">
                                        <label for="field_form-epochs_count">Количество эпох</label>
                                        <input name="epochs_count" id="field_form-epochs_count" type="number" value="{{ request.terra_project.training.epochs_count }}" />
                                    </div>
                                    <div class="field-form field-inline">
                                        <label for="field_form-learning_rate">Learning rate</label>
                                        <input name="optimazer[params][main][learning_rate]" id="field_form-learning_rate" type="number" value="" />
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="params-item params-optimazer-extra collapsable hidden">
                            <div class="params-title">Параметры оптимизатора</div>
                            <div class="inner form-inline-label"></div>
                        </div>

                        <div class="params-item output-params-block collapsable">
                            <div class="params-title">Параметры Outputs</div>
                            <div class="param-item inner">
                                <div class="outputs-content">
                                    {% for index, layer in request.terra_project.layers.items.items %}
                                        {% if layer.config.location_type == "output" %}
                                            <div class="params-title">Параметры слоя «{{ layer.config.name }}»</div>
                                            <div class="output-item form-inline-label" id="output-{{ index }}">
                                                <div class="field-form field-inline output-block select-task">
                                                    <label for="output-{{ index }}-task">Task:</label>
                                                        <select id="output-{{ index }}-task" name="output-{{ index }}-task" class="jquery-ui-menuselect task-select">
                                                            {% for param in request.terra_project.compile %}
                                                                <option value="{{ param }}">{{ param }}</option>
                                                            {% endfor %}
                                                        </select>
                                                </div>
                                                <div class="field-form field-inline output-block select-loss">
                                                    <label for="output-{{ index }}-loss">Loss:</label>
                                                        <select id="output-{{ index }}-loss" name="output-{{ index }}-loss" class="jquery-ui-menuselect loss-select">
                                                            {% for param in request.terra_project.compile.classification.metrics %}
                                                                <option value="{{ param }}">{{ param }}</option>
                                                            {% endfor %}
                                                        </select>
                                                </div>
                                                <div class="field-form field-inline output-block select-metric">
                                                    <label for="output-{{ index }}-metric">Metric:</label>
                                                     <select id="output-{{ index }}-metric" name="output-{{ index }}-metric" class="jquery-ui-menuselect metric-select">
                                                         {% for param in request.terra_project.compile.classification.losses %}
                                                             <option value="{{ param }}">{{ param }}</option>
                                                         {% endfor %}
                                                        </select>
                                                </div>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            </div>
                        </div>

                        <div class="params-item checkpoint-block collapsable">
                            <div class="params-title">Checkpoint</div>
                            <div class="checkpoint-item inner form-inline-label">
                                 <div class="field-form field-inline output-block">
                                     <label for="display">Монитор:</label>
                                     <select name="display" id="display" class="jquery-ui-menuselect">
                                         <option value="none">none</option>
                                     </select>
                                 </div>
                                <div class="field-form field-inline output-block">
                                     <label for="mode">Режим:</label>
                                     <select name="mode" id="mode" class="jquery-ui-menuselect">
                                         <option value="none">none</option>
                                     </select>
                                 </div>
                                <div class="switchers">
                                    <div class="field-form field-inline">
                                        <label for="save-best">Сохранить лучшее:</label>
                                        <div class="checkout-switch">
                                            <input type="checkbox" id="save-best" name="save-best"/>
                                            <span class="switcher"></span>
                                        </div>
                                    </div>
                                     <div class="field-form field-inline">
                                        <label for="save-weight">Сохранить веса:</label>
                                        <div class="checkout-switch">
                                            <input type="checkbox" id="save-weight" name="save-weight"/>
                                            <span class="switcher"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="params-item callbacks-switchers collapsable">
                            <div class="params-title">Выводить</div>
                            <div class="inner callback-item">
                                {% for name, callback in request.terra_project.callbacks.items %}
                                    <div class="field-form field-inline field-reverse">
                                        <label for="callback-{{ name }}">{{ callback.label }}</label>
                                         <div class="checkout-switch">
                                            <input type="checkbox" id="callback-{{ name }}" name="{{ name }}"{% if callback.value %} checked="checked"{% endif %} />
                                            <span class="switcher"></span>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="params-item">
                    <div class="inner actions">
                        <div class="actions-form">
                            <div class="item training">
                                <button>Обучить</button>
                            </div>
                            <div class="item evaluate">
                                <button disabled="disabled">Evaluate</button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock content_block %}

{% block modal_window %}
{{ block.super }}
<div id="modal-window-warning" class="modal-window-container">
    <div class="wrapper"></div>
</div>
{% endblock modal_window %}
