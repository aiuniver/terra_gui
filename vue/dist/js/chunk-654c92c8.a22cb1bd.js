(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-654c92c8"],{"23d0":function(t,e,s){"use strict";s("8c27")},"2fea":function(t,e,s){"use strict";s("cd0b")},"5bc3":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"page-servers"},[s("div",{staticClass:"page-servers__list"},[s("scrollbar",{staticClass:"page-servers__scroll"},[s("div",{staticClass:"page-servers__table-wrapper"},[t.showTable?s("ServerTable",{attrs:{servers:t.servers},on:{instruction:t.openInstruction}}):s("p",{staticClass:"page-servers__noserver"},[t._v("Нет добавленных серверов демо-панелий")]),s("span",{staticClass:"page-servers__btn",on:{click:function(e){t.addNew=!0}}},[s("i",{staticClass:"ci-icon ci-plus_circle"}),s("span",[t._v("Добавить сервер")])])],1)])],1),s("div",{staticClass:"page-servers__new"},[s("NewServer",{directives:[{name:"show",rawName:"v-show",value:t.addNew,expression:"addNew"}],on:{addServer:t.newServer}})],1),s("at-modal",{staticClass:"modal",attrs:{okText:"Читать инструкцию"},on:{"on-confirm":function(e){return t.openInstruction(t.serverID)}},scopedSlots:t._u([{key:"header",fn:function(){return[s("span",{staticClass:"modal-title"},[t._v("Сервер демо-панели добавлен")])]},proxy:!0}]),model:{value:t.serverModal,callback:function(e){t.serverModal=e},expression:"serverModal"}},[s("p",[t._v("Ознакомьтесь с дальнейшими действиями в "),s("span",{staticClass:"clickable",on:{click:function(e){return t.openInstruction(t.serverID)}}},[t._v("Инструкции")])]),s("p",[t._v("Вы также сможете найти ее в таблице серверов на владке Серверы демо-панелей в вашем Профиле")])]),s("at-modal",{staticClass:"modal",scopedSlots:t._u([{key:"header",fn:function(){return[s("span",{staticClass:"modal-title"},[t._v("Инструкция по настройке сервера демо-панели")])]},proxy:!0}]),model:{value:t.InstructionModal,callback:function(e){t.InstructionModal=e},expression:"InstructionModal"}},[s("t-field",{attrs:{label:"Приватный SSH-ключ"}},[s("div",{staticClass:"ssh-wrapper"},[s("span",{ref:"private",staticClass:"ssh"},[t._v(t._s(t.private_key))]),t._v(" "),s("i",{staticClass:"btn-copy",attrs:{title:"Скопировать"},on:{click:function(e){return t.copy(t.$refs.private)}}}),t._v(" "),s("span",{staticClass:"clickable"},[t._v("Скачать")])])]),s("t-field",{attrs:{label:"Публичный  SSH-ключ"}},[s("div",{staticClass:"ssh-wrapper"},[s("span",{ref:"public",staticClass:"ssh"},[t._v(t._s(t.public_key))]),t._v(" "),s("i",{staticClass:"btn-copy",attrs:{title:"Скопировать"},on:{click:function(e){return t.copy(t.$refs.public)}}}),t._v(" "),s("span",{staticClass:"clickable"},[t._v("Скачать")])])])],1)],1)},n=[],a=s("1da1"),i=s("5530"),o=(s("96cf"),s("b64b"),s("7db0"),s("d3b7"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",{staticClass:"server-table"},[t._m(0),s("tbody",t._l(t.servers,(function(e){return s("tr",{key:e.id},[s("td",[t._v(t._s(e.domain_name))]),s("td",[t._v(t._s(e.ip_address))]),s("td",[t._v(t._s(e.user))]),s("td",[t._v(t._s(e.port_ssh))]),s("td",[t._v(t._s(e.port_http))]),s("td",[t._v(t._s(e.port_https))]),s("td",{staticClass:"clickable"},[s("span",{on:{click:function(s){return t.instruction(e.id)}}},[t._v("Открыть")])]),e.state.error?s("td",[s("span",[t._v(t._s(e.state.error))]),s("i",{staticClass:"ci-icon ci-info_circle_outline"})]):s("td",[t._v(t._s(e.state.value))]),s("td",{staticClass:"clickable",on:{click:function(s){return t.setup(e.id)}}},[s("i",{class:["ci-icon",t.getIcon(e.state.name)]}),s("span",[t._v(t._s(t.getAction(e.state.name)))])])])})),0)])}),c=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",[t._v("Доменное имя")]),s("th",[t._v("IP адрес")]),s("th",[t._v("Имя пользователя")]),s("th",[t._v("SSH порт")]),s("th",[t._v("HTTP порт")]),s("th",[t._v("HTTPS порт")]),s("th",[t._v("Инструкция")]),s("th",[t._v("Состояние")]),s("th",{staticStyle:{"min-width":"144px"}})])])}],l={name:"ServerTable",props:{servers:Array},methods:{instruction:function(t){this.$emit("instruction",t)},setup:function(t){this.$store.dispatch("servers/setup",{id:t})},getIcon:function(t){return"ready"===t?"ci-redo":"idle"===t?"":"ci-play_arrow"},getAction:function(t){return"ready"===t?"Обновить запуск":"idle"===t?"":"Запустить"}}},p=l,u=(s("f2e3"),s("2877")),d=Object(u["a"])(p,o,c,!1,null,"69467395",null),h=d.exports,v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-server"},[s("p",{staticClass:"new-server__header"},[t._v("Добавление сервера демо-панели")]),s("form",{staticClass:"new-server__form",on:{submit:function(e){return e.preventDefault(),t.addServer.apply(null,arguments)}}},[s("t-field",{attrs:{label:"Доменное имя"}},[s("DInputText",{attrs:{placeholder:""},model:{value:t.domain_name,callback:function(e){t.domain_name=e},expression:"domain_name"}})],1),s("t-field",{attrs:{label:"IP адрес"}},[s("VueIP",{attrs:{ip:t.ip_address,onChange:t.change}})],1),s("t-field",{attrs:{label:"Имя пользователя"}},[s("DInputText",{attrs:{placeholder:""},model:{value:t.user,callback:function(e){t.user=e},expression:"user"}})],1),s("div",{staticClass:"new-server__ports"},[s("t-field",{attrs:{label:"SSH порт"}},[s("DInputNumber",{attrs:{placeholder:""},model:{value:t.port_ssh,callback:function(e){t.port_ssh=e},expression:"port_ssh"}})],1),s("t-field",{attrs:{label:"HTTP порт"}},[s("DInputNumber",{attrs:{placeholder:""},model:{value:t.port_http,callback:function(e){t.port_http=e},expression:"port_http"}})],1),s("t-field",{attrs:{label:"HTTPS порт"}},[s("DInputNumber",{attrs:{placeholder:""},model:{value:t.port_https,callback:function(e){t.port_https=e},expression:"port_https"}})],1)],1),s("t-button",{staticClass:"new-server__btn",attrs:{disabled:!t.validForm,loading:t.loading}},[t._v("Добавить")])],1),t._m(0)])},_=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-server__error"},[s("p",{staticClass:"new-server__error--header"},[t._v("Ошибка добавления сервера демо-панели")]),s("p",{staticClass:"new-server__error--info"},[t._v(" Неверно указан IP адрес. Отредактируйте поле и снова нажмите кнопку Добавить ")])])}],f=(s("3ca3"),s("ddb0"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"vue-ip",class:{"show-port":!1!==t.portCopy,"material-theme":"material"===t.theme,active:t.active,valid:t.valid}},t._l(t.ipCopy,(function(e,r){return s("div",{key:r,staticClass:"segment"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.ipCopy[r],expression:"ipCopy[index]"}],ref:"ipSegment",refInFor:!0,attrs:{type:"number",placeholder:t.placeholderPos(r),maxlength:"3"},domProps:{value:t.ipCopy[r]},on:{paste:function(e){return t.paste(e)},keydown:function(e){return t.ipKeydown(e,r)},focus:function(e){return t.ipFocus(r)},blur:t.blur,input:[function(e){e.target.composing||t.$set(t.ipCopy,r,e.target.value)},t.input]}})])})),0)}),m=[],b=(s("a9e3"),s("ac1f"),s("1276"),s("d81d"),s("a15b"),s("00b4"),{props:{onChange:Function,ip:{required:!0,type:String},port:{type:[String,Number,Boolean],default:!1},placeholder:{type:[Boolean],default:!1},theme:{type:[String,Boolean],default:!1}},data:function(){return{ipCopy:["","","",""],portCopy:null,valid:!1,active:!1}},beforeMount:function(){this.copyValue(this.ip,this.port)},watch:{ip:function(t){this.copyValue(t,this.port)},port:function(t){this.copyValue(this.ip,t)}},methods:{input:function(t){t.target.value||(t.target.value="")},placeholderPos:function(t){if(!this.placeholder)return"";switch(t){case 0:return"192";case 1:return"168";case 2:return"0";case 3:return"1"}},ipFocus:function(t){this.active=!0,this.ipCopy[t]="",this.changed()},clearAll:function(){this.ipCopy=["","","",""],this.portCopy=null,this.valid=!1},blur:function(){this.active=!1},portFocus:function(){this.active=!0,this.portCopy=null,this.changed()},paste:function(t){this.$refs.ipSegment[0].focus();var e=t.clipboardData.getData("text/plain"),s=e.indexOf(":");if(!1===this.port){console.warn("A IP address with a port has been entered but this module has no port attribute. Please enable it update the port."),this.clearAll();var r=e.split(":");return this.copyValue(r[0],!1),void this.$refs.ipSegment[0].blur()}switch(s){case-1:this.copyValue(e,null),this.changed(),this.$refs.ipSegment[0].blur();break;default:var n=e.split(":");this.copyValue(n[0],n[1]),this.changed(),this.$refs.ipSegment[0].blur();break}},ipKeydown:function(t,e){var s=this,r=t.keyCode||t.which;8!==r&&37!==r||0===this.ipCopy[e].length&&void 0!==this.ipCopy[e-1]&&this.$refs.ipSegment[e-1].focus(),setTimeout((function(){"0"===s.ipCopy[e]?s.moveToNextIpSegment(e,!1):s.moveToNextIpSegment(e),s.changed()}))},moveToNextIpSegment:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e?this.ipCopy[t].length>=3&&void 0!==this.ipCopy[t+1]&&this.$refs.ipSegment[t+1].focus():e||void 0!==this.ipCopy[t+1]&&this.$refs.ipSegment[t+1].focus()},changed:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.ipCopy,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.portCopy,s=this.arrayToIp(t);this.onChange(s,e,this.validateIP(t))},copyValue:function(t,e){t&&this.ipToArray(t),this.portCopy=e,this.valid=this.validateIP(this.ipCopy),this.changed()},ipToArray:function(t){var e=[];t.split(".").map((function(t){(isNaN(t)||t<0||t>255)&&(t=255),e.push(t)})),4!==e.length?(console.error("Not valid, so clearing ip",e),this.clearAll()):this.ipCopy=e},arrayToIp:function(t){return t.join(".")},validateIP:function(t){var e=this.arrayToIp(t);return/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}}}),g=b,y=(s("2fea"),Object(u["a"])(g,f,m,!1,null,"5546660a",null)),C=y.exports,w={name:"NewServer",data:function(){return{ip_address:"255.255.255.255",ipValid:null,domain_name:"",user:"",port_ssh:0,port_http:0,port_https:0,loading:!1}},components:{VueIP:C,DInputNumber:function(){return s.e("chunk-2d9c5a97").then(s.bind(null,"8267"))},DInputText:function(){return s.e("chunk-0c1b8f7d").then(s.bind(null,"db2e"))}},computed:{validForm:function(){return!!(this.ipValid&&this.domain_name&&this.user&&this.port_ssh&&this.port_http&&this.port_https)}},methods:{change:function(t,e,s){this.ip_address=t,this.ipValid=s},addServer:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.$store.dispatch("servers/addServer",{domain_name:t.domain_name,ip_address:t.ip_address,user:t.user,port_ssh:t.port_ssh,port_http:t.port_http,port_https:t.port_https});case 3:s=e.sent,r=s.id,t.$emit("addServer",r),t.loading=!1;case 7:case"end":return e.stop()}}),e)})))()}}},S=w,k=(s("991d"),Object(u["a"])(S,v,_,!1,null,"0a650d56",null)),I=k.exports,x=s("2f62"),T={name:"servers",components:{ServerTable:h,NewServer:I},data:function(){return{addNew:!1,serverModal:!1,InstructionModal:!1,serverID:null,private_key:null,public_key:null}},computed:Object(i["a"])(Object(i["a"])({},Object(x["b"])({servers:"servers/getServers"})),{},{showTable:function(){return!!Object.keys(this.$store.getters["servers/getServers"]).length},getServer:function(){var t=this;return this.servers.find((function(e){return e.id===t.serverID}))}}),methods:{openManual:function(t){this.selectedServer=t,this.manualModal=!0},copy:function(t){var e=window.getSelection(),s=document.createRange();s.selectNodeContents(t),e.removeAllRanges(),e.addRange(s),document.execCommand("copy"),e.removeAllRanges()},newServer:function(t){this.serverID=t,this.serverModal=!0},openInstruction:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function s(){var r,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return e.serverID=t,e.serverModal=!1,e.InstructionModal=!0,s.next=5,e.$store.dispatch("servers/getInstruction",{id:t});case 5:r=s.sent,n=r.data,e.private_key=n.private_ssh_key,e.public_key=n.public_ssh_key;case 9:case"end":return s.stop()}}),s)})))()}},created:function(){this.$store.dispatch("servers/getServers")}},$=T,N=(s("23d0"),Object(u["a"])($,r,n,!1,null,"0b4b2a76",null));e["default"]=N.exports},7558:function(t,e,s){},"8c27":function(t,e,s){},"991d":function(t,e,s){"use strict";s("b689")},b689:function(t,e,s){},cd0b:function(t,e,s){},f2e3:function(t,e,s){"use strict";s("7558")}}]);