(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b033afa"],{"13bb":function(e,t,n){},"196b":function(e,t,n){},"1a50":function(e,t,n){},"1a8a":function(e,t,n){},"26f1":function(e,t,n){"use strict";n("a66e")},"2d4c":function(e,t,n){"use strict";n("6a73")},3188:function(e,t,n){"use strict";n("13bb")},4067:function(e,t,n){},"4d8f":function(e,t,n){"use strict";n("1a8a")},"50ab":function(e,t,n){"use strict";n("4067")},"5e1d":function(e,t,n){"use strict";n("e546")},"616b":function(e,t,n){"use strict";n("cee6")},"6a73":function(e,t,n){},"6e64":function(e,t,n){"use strict";n("1a50")},a3f2:function(e,t,n){"use strict";n("196b")},a66e:function(e,t,n){},becc:function(e,t,n){},cee6:function(e,t,n){},e4f6:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",{staticClass:"page-modeling"},[n("div",{staticClass:"cont"},[n("LoadModel",{model:{value:e.dialogLoadModel,callback:function(t){e.dialogLoadModel=t},expression:"dialogLoadModel"}}),n("SaveModel",{attrs:{image:e.imageModel},model:{value:e.dialogSaveModel,callback:function(t){e.dialogSaveModel=t},expression:"dialogSaveModel"}}),n("Toolbar",{on:{actions:e.actions}}),n("Blocks",{ref:"container"}),n("Params"),n("CopyModal",{attrs:{title:"Код на keras"},model:{value:e.kerasModal,callback:function(t){e.kerasModal=t},expression:"kerasModal"}},[e._v(e._s(e.keras))])],1)])},s=[],o=n("1da1"),a=(n("96cf"),n("fb6a"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"toolbar"},[n("ul",{staticClass:"toolbar__menu"},[n("li",{class:["toolbar__menu--item",{disabled:!1}],attrs:{title:"Загрузить модель"},on:{click:function(t){return e.click(t,"load")}}},[n("i",{staticClass:"t-icon icon-model-load"})]),n("li",{class:["toolbar__menu--item",{disabled:e.isSave}],attrs:{title:"Сохранить модель"},on:{click:function(t){return e.click(t,"save")}}},[n("i",{staticClass:"t-icon icon-model-save"})]),n("li",{class:["toolbar__menu--item",{disabled:e.isValidation}],attrs:{title:"Валидация"},on:{click:function(t){return e.click(t,"validation")}}},[n("i",{staticClass:"t-icon icon-model-validation"})]),n("li",{class:["toolbar__menu--item",{disabled:e.isClear}],attrs:{title:"Очистить"},on:{click:function(t){return e.click(t,"clear")}}},[n("i",{staticClass:"t-icon icon-model-clear"})]),n("hr"),n("li",{class:["toolbar__menu--item",{disabled:e.isInput}],attrs:{title:"Входящий слой"},on:{click:function(t){return e.click(t,"input")}}},[n("i",{staticClass:"t-icon icon-layer-input"})]),n("li",{class:["toolbar__menu--item",{disabled:!1}],attrs:{title:"Промежуточный слой"},on:{click:function(t){return e.click(t,"middle")}}},[n("i",{staticClass:"t-icon icon-layer-middle"})]),n("li",{class:["toolbar__menu--item",{disabled:e.isOutput}],attrs:{title:"Исходящий слой"},on:{click:function(t){return e.click(t,"output")}}},[n("i",{staticClass:"t-icon icon-layer-output"})]),n("hr"),n("li",{class:["toolbar__menu--item",{disabled:e.isKeras}],attrs:{title:"Код на Keras"},on:{click:function(t){return e.click(t,"keras")}}},[n("i",{staticClass:"t-icon icon-keras-code"})])])])}),l=[],r=n("2909"),c=n("5530"),u=(n("07ac"),n("4de4"),n("d81d"),n("caad"),n("2532"),n("7db0"),n("2f62")),d={name:"Toolbar",data:function(){return{}},computed:Object(c["a"])(Object(c["a"])({},Object(u["b"])({blocks:"modeling/getBlocks",errors:"modeling/getErrorsBlocks",project:"projects/getProject",status:"modeling/getStatus"})),{},{isSave:function(){return this.isKeras},isClear:function(){return!this.blocks.length},isKeras:function(){var e=Object.values(this.errors);return!e.length||e.filter((function(e){return null!==e})).length},isValidation:function(){var e=this.blocks.map((function(e){return e.group}));return!(e.includes("input")&&e.includes("output"))},isInput:function(){var e;return!!this.blocks.find((function(e){return"input"===e.group}))&&!(null===(e=this.project)||void 0===e||!e.dataset)},isOutput:function(){var e;return!!this.blocks.find((function(e){return"output"===e.group}))&&!(null===(e=this.project)||void 0===e||!e.dataset)}}),methods:{click:function(e,t){var n=e.currentTarget,i=Object(r["a"])(null===n||void 0===n?void 0:n.classList)||[];i.includes("disabled")||this.$emit("actions",t)}}},h=d,m=(n("6e64"),n("2877")),p=Object(m["a"])(h,a,l,!1,null,"b24c2c18",null),v=p.exports,f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"t-block"},[n("VueLink",{attrs:{lines:e.lines}}),e._l(e.blocks,(function(t){return n("VueBlock",e._b({key:t.id,ref:"block_"+t.id,refInFor:!0,attrs:{options:e.optionsForChild,linkingCheck:e.tempLink,icons:e.icons,filter:e.filter,errors:e.errors},on:{linkingStart:function(n){return e.linkingStart(t,n)},linkingStop:function(n){return e.linkingStop(t,n)},linkingBreak:function(n){return e.linkingBreak(t,n)},select:function(n){return e.blockSelect(t)},position:function(n){return e.position(t,n)},moveBlock:e.moveBlock,clickIcons:function(n){return e.clickIcons(n,t)}}},"VueBlock",t,!1))})),n("div",{staticClass:"btn-zoom"},[n("div",{staticClass:"btn-zoom__item"},[n("i",{staticClass:"t-icon icon-zoom-inc",on:{click:function(t){return e.zoom(1)}}})]),n("hr"),n("div",{staticClass:"btn-zoom__item"},[n("i",{staticClass:"t-icon icon-zoom-reset",on:{click:function(t){return e.zoom(0)}}})]),n("hr"),n("div",{staticClass:"btn-zoom__item"},[n("i",{staticClass:"t-icon icon-zoom-dec",on:{click:function(t){return e.zoom(-1)}}})])]),n("div",{staticClass:"t-block__center",style:e.scaleCenter},[n("div",{staticClass:"t-block__center--vertical"}),n("div",{staticClass:"t-block__center--horizontal"})])],2)},g=[],k=n("b85c"),b=(n("c740"),n("99af"),n("c7a7")),y=n.n(b),_=n("8785"),x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"t-block-modeling",style:e.style,on:{mouseover:function(t){e.hover=!0},mouseleave:function(t){e.hover=!1}}},[n("div",{class:["t-block-modeling__header",e.group,{selected:e.selected},{error:!!e.error}]},[n("div",{staticClass:"t-block-modeling__header--title",attrs:{title:e.name}},[e._v(e._s(e.typeLabel)+": "+e._s(e.name))]),n("div",{staticClass:"t-block-modeling__header--parametr",attrs:{title:e.parametr}},[e._v(e._s(e.parametr))])]),n("div",{staticClass:"t-block-modeling__base"}),e.error?n("div",{directives:[{name:"show",rawName:"v-show",value:e.hover||e.selected,expression:"hover || selected"}],staticClass:"t-block-modeling__error"},[e._v(" "+e._s(e.error)+" ")]):e._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:e.hover||e.selected,expression:"hover || selected"}],staticClass:"t-block-modeling__hover",style:e.styleHover},[e._l(e.iconsFilter,(function(t,i){return[n("i",{key:"icon_"+i,class:["t-icon",t.icon],on:{click:function(n){return e.$emit("clickIcons",t)}}})]}))],2),n("div",{staticClass:"t-block-modeling__inputs"},e._l(e.inputs,(function(t,i){return n("div",{key:"input"+i,staticClass:"input inputSlot",class:{active:t.active,"input--linking-active":e.linkingCheck&&!e.linking},on:{mouseup:function(t){return e.slotMouseUp(t,i)},mousedown:function(t){return e.slotBreak(t,i)}}})})),0),n("div",{staticClass:"t-block-modeling__outputs"},e._l(e.outputs,(function(t,i){return n("div",{key:"output"+i,staticClass:"output",class:[{active:e.hover&&!e.linkingCheck},e.typeLink[i]],on:{mousedown:function(t){return e.slotMouseDown(t,i)}}})})),0)])},w=[],C=(n("a9e3"),n("a15b"),{name:"VueBlock",props:{id:{type:Number},linkingCheck:{type:Object},errors:{type:Object,default:function(){}},name:{type:String},group:{type:String},position:{type:Array,default:function(){return[]},validator:function(e){return"number"===typeof e[0]&&"number"===typeof e[1]}},selected:Boolean,type:String,typeLabel:String,title:{type:String,default:"Title"},inputs:Array,outputs:Array,parameters:{type:Object,default:function(){}},options:{type:Object},icons:Array,filter:{type:Object,default:function(){}},shape:Object,bind:Object},data:function(){return{hover:!1,hasDragged:!1,typeLink:["bottom","right","left"]}},computed:{iconsFilter:function(){var e=this;return this.icons.filter((function(t){return e.filter[e.group].includes(t.event)}))},error:function(){var e;return(null===(e=this.errors)||void 0===e?void 0:e[this.id])||""},parametr:function(){var e,t,n,i=Object.values((null===(e=this.parameters)||void 0===e?void 0:e.main)||{}).filter((function(e){return e}));return"input"===this.group?(null===(t=this.shape)||void 0===t||null===(n=t.input)||void 0===n?void 0:n.join(" "))||"":i.join(" ")},styleHover:function(){var e=this.iconsFilter.length;return{right:-32*e-3+"px"}},style:function(){return{left:this.options.center.x+this.position[0]*this.options.scale+"px",top:this.options.center.y+this.position[1]*this.options.scale+"px",width:this.options.width+"px",transform:"scale("+this.options.scale+")",transformOrigin:"top left",zIndex:this.selected||this.hover?10:1}}},created:function(){this.mouseX=0,this.mouseY=0,this.lastMouseX=0,this.lastMouseY=0,this.linking=!1,this.dragging=!1},mounted:function(){document.documentElement.addEventListener("mousemove",this.handleMove,!0),document.documentElement.addEventListener("mousedown",this.handleDown,!0),document.documentElement.addEventListener("mouseup",this.handleUp,!0)},beforeDestroy:function(){document.documentElement.removeEventListener("mousemove",this.handleMove,!0),document.documentElement.removeEventListener("mousedown",this.handleDown,!0),document.documentElement.removeEventListener("mouseup",this.handleUp,!0)},methods:{getHeight:function(){return this.$el.clientHeight},handleMove:function(e){if(this.mouseX=e.pageX||e.clientX+document.documentElement.scrollLeft,this.mouseY=e.pageY||e.clientY+document.documentElement.scrollTop,this.dragging&&!this.linking){var t=this.mouseX-this.lastMouseX,n=this.mouseY-this.lastMouseY;this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY,this.moveWithDiff(t,n),this.hasDragged=!0}},handleDown:function(e){this.mouseX=e.pageX||e.clientX+document.documentElement.scrollLeft,this.mouseY=e.pageY||e.clientY+document.documentElement.scrollTop,this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY;var t=e.target||e.srcElement;this.$el.contains(t)&&1===e.which&&(this.dragging=!0,this.$emit("select"),e.preventDefault&&e.preventDefault())},handleUp:function(){this.dragging&&(this.dragging=!1,this.hasDragged&&(this.$emit("moveBlock"),this.save(),this.hasDragged=!1)),this.linking&&(this.linking=!1)},slotMouseDown:function(e,t){this.linking=!0,this.$emit("linkingStart",t),e.preventDefault&&e.preventDefault()},slotMouseUp:function(e,t){this.$emit("linkingStop",t),e.preventDefault&&e.preventDefault()},slotBreak:function(e,t){this.linking=!0,this.$emit("linkingBreak",t),e.preventDefault&&e.preventDefault()},save:function(){this.$emit("update")},moveWithDiff:function(e,t){var n=this.position[0]+e/this.options.scale,i=this.position[1]+t/this.options.scale;this.$emit("position",[n,i])}}}),M=C,S=(n("50ab"),Object(m["a"])(M,x,w,!1,null,"144c8c08",null)),$=S.exports,j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{attrs:{width:"100%",height:"100%"}},[e._l(e.renderedPathes,(function(t,i){return n("g",{key:"k"+i},[e.outline?n("path",{style:t.outlineStyle,attrs:{d:t.data}}):e._e(),e.outline?e._e():n("circle",{attrs:{cx:t.circle[0],cy:t.circle[1],r:3*t.scale,fill:t.style.stroke}}),e.outline?e._e():n("circle",{attrs:{cx:t.circle[2],cy:t.circle[3],r:3*t.scale,fill:t.style.stroke}}),n("path",{style:t.style,attrs:{d:t.data}})])})),n("g",e._l(e.renderedArrows,(function(e,t){return n("path",{key:"a"+t,style:e.style,attrs:{d:"M -1 -1 L 0 1 L 1 -1 z",transform:e.transform}})})),0)],2)},O=[],E=(n("159b"),{props:{lines:{type:Array,default:function(){return[]}},outline:{type:Boolean,default:!1}},methods:{distance:function(e,t,n,i){return Math.sqrt((n-e)*(n-e)+(i-t)*(i-t))},computeConnectionPoint:function(e,t,n,i,s){var o=this.distance(e,t,n,i),a={x:e,y:t},l={x:e+.25*o,y:t},r={x:n-.25*o,y:i},c={x:n,y:i},u=(1-s)*(1-s)*(1-s),d=(1-s)*(1-s)*3*s,h=3*(1-s)*(s*s),m=s*s*s,p=u*a.x+d*l.x+h*r.x+m*c.x,v=u*a.y+d*l.y+h*r.y+m*c.y;return{x:p,y:v}}},computed:{renderedPathes:function(){var e=this;if(!this.lines)return[];var t=[];return this.lines.forEach((function(n){var i=.2*e.distance(n.x1,n.y1,n.x2,n.y2),s=[n.x1,n.y1,n.x2,n.y2],o=["M ".concat(n.x1,", ").concat(n.y1," C ").concat(n.x1,", ").concat(n.y1+i,", ").concat(n.x2,", ").concat(n.y2-i,", ").concat(n.x2,", ").concat(n.y2),"M ".concat(n.x1,", ").concat(n.y1," C ").concat(n.x1+i,", ").concat(n.y1,", ").concat(n.x2-i,", ").concat(n.y2,", ").concat(n.x2,", ").concat(n.y2),"M ".concat(n.x1,", ").concat(n.y1," C ").concat(n.x1-i,", ").concat(n.y1,", ").concat(n.x2+i,", ").concat(n.y2,", ").concat(n.x2,", ").concat(n.y2)];t.push({data:o[n.slot]||o[0],circle:s,scale:n.scale||1,style:n.style,outlineStyle:n.outlineStyle})})),t},renderedArrows:function(){var e=this;if(!this.lines)return[];var t=[];return this.lines.forEach((function(n){var i=e.computeConnectionPoint(n.x1,n.y1,n.x2,n.y2,.5),s=e.computeConnectionPoint(n.x1,n.y1,n.x2,n.y2,.501),o=-Math.atan2(s.x-i.x,s.y-i.y),a=180*(o>=0?o:2*Math.PI+o)/Math.PI;t.push({transform:"translate(".concat(i.x,", ").concat(i.y,") rotate(").concat(a-15,")"),style:{stroke:"rgb(80, 125, 150)",strokeWidth:2*n.style.strokeWidth,fill:n.style.stroke}})})),t}}}),D=E,L=Object(m["a"])(D,j,O,!1,null,"a3f12e28",null),B=L.exports,Y={name:"VueBlockContainer",components:{VueBlock:$,VueLink:B},props:{blocksContent:{type:Array,default:function(){return[]}},options:{type:Object}},data:function(){return{icons:[{icon:"icon-modeling-copy-white",event:"clone"},{icon:"icon-modeling-link-remove",event:"link"},{icon:"icon-modeling-remove",event:"remove"}],dragging:!1,centerX:0,centerY:0,scale:1,tempLink:null,selectedBlock:null,hasDragged:!1,mouseX:0,mouseY:0,lastMouseX:0,lastMouseY:0,minScale:.2,maxScale:5,linking:!1,linkStartData:null,inputSlotClassName:"inputSlot",defaultScene:{blocks:[],links:[],container:{}}}},computed:Object(c["a"])(Object(c["a"])({},Object(u["b"])({project:"projects/getProject"})),{},{scaleCenter:function(){return{top:this.centerY+"px",left:this.centerX+"px",transform:"scale("+this.scale+")",transformOrigin:"top left"}},filter:function(){var e,t;return{input:null!==(e=this.project)&&void 0!==e&&e.dataset?["link"]:["clone","link","remove"],middle:["clone","link","remove"],output:null!==(t=this.project)&&void 0!==t&&t.dataset?["link"]:["clone","link","remove"]}},errors:function(){return this.$store.getters["modeling/getErrorsBlocks"]},blocks:{set:function(e){this.$store.dispatch("modeling/setBlocks",e)},get:function(){return this.$store.getters["modeling/getBlocks"]}},links:{set:function(e){console.log(e),this.$store.dispatch("modeling/setLinks",e)},get:function(){return this.$store.getters["modeling/getLinks"]}},optionsForChild:function(){return{width:180,titleHeight:42,scale:this.scale,inputSlotClassName:this.inputSlotClassName,center:{x:this.centerX,y:this.centerY}}},container:function(){return{centerX:this.centerX,centerY:this.centerY,scale:this.scale}},lines:function(){var e,t=this,n=[],i=Object(k["a"])(this.links);try{var s=function(){var i=e.value,s=t.blocks.find((function(e){return e.id===i.originID})),o=t.blocks.find((function(e){return e.id===i.targetID}));if(!s||!o)return console.log("Remove invalid link",i),t.$store.dispatch("modeling/removeLink",i.id),"continue";if(s.id===o.id)return console.log("Loop detected, remove link",i),t.$store.dispatch("modeling/removeLink",i.id),"continue";var a=t.getConnectionPos(s,i.originSlot,!1),l=t.getConnectionPos(o,i.targetSlot,!0);if(!a||!l)return console.log("Remove invalid link (slot not exist)",i),t.$store.dispatch("modeling/removeLink",i.id),"continue";var r=a.x,c=a.y,u=l.x,d=l.y;n.push({x1:r,y1:c,x2:u,y2:d,slot:i.originSlot,scale:t.scale,style:{stroke:"rgb(101, 185, 244)",strokeWidth:2*t.scale,fill:"none",zIndex:999},outlineStyle:{stroke:"#666",strokeWidth:2*t.scale,strokeOpacity:.6,fill:"none",zIndex:999}})};for(i.s();!(e=i.n()).done;)s()}catch(o){i.e(o)}finally{i.f()}return this.tempLink&&(this.tempLink.style={stroke:"#8f8f8f",strokeWidth:2*this.scale,fill:"none"},n.push(this.tempLink)),n}}),methods:{getCenter:function(){this.scale>1.5&&(this.scale=1.5);var e=this.$el.clientWidth/2-this.optionsForChild.width/2-this.centerX,t=this.$el.clientHeight/2-this.centerY;return console.log(this.centerX),console.log(this.centerY),[e,t]},getError:function(e){var t;return(null===(t=this.errorsBlocks)||void 0===t?void 0:t[e])||""},clickIcons:function(e,t){var n=e.event;console.log(n),"remove"===n&&this.$store.dispatch("modeling/removeBlock",t),"clone"===n&&this.$store.dispatch("modeling/cloneBlock",t),"link"===n&&this.$store.dispatch("modeling/removeLinkToBlock",t)},handleMauseOver:function(e){this.mouseIsOver="mouseenter"===e.type},keyup:function(e){var t=e.code,n=e.ctrlKey,i=this.mouseIsOver;console.log(i,t),i&&"Delete"===t&&this.selectedBlock,i&&"KeyC"===t&&n&&this.selectedBlock},zoom:function(e){if(0===e)return this.scale=1,this.centerX=this.$el.clientWidth/2,void(this.centerY=this.$el.clientHeight/2);var t=1===e?1.1:.9090909090909091;if(this.scale*=t,this.scale<this.minScale)this.scale=this.minScale;else if(this.scale>this.maxScale)this.scale=this.maxScale;else{var n=(this.$el.clientWidth/2-this.centerX)*(t-1),i=(this.$el.clientHeight/2-this.centerY)*(t-1);this.centerX-=n,this.centerY-=i}},handleMove:function(e){var t=Object(_["d"])(this.$el,e);if(this.mouseX=t.x,this.mouseY=t.y,this.dragging){console.log("handleMove");var n=this.mouseX-this.lastMouseX,i=this.mouseY-this.lastMouseY;this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY,this.centerX+=n,this.centerY+=i,this.hasDragged=!0}if(this.linking&&this.linkStartData){var s=this.getConnectionPos(this.linkStartData.block,this.linkStartData.slotNumber,!1);this.tempLink={x1:s.x,y1:s.y,x2:this.mouseX,y2:this.mouseY,slot:this.linkStartData.slotNumber}}},handleDown:function(e){console.log("handleDown");var t=e.target||e.srcElement;if((t===this.$el||t.matches("svg, svg *"))&&1===e.which){this.dragging=!0;var n=Object(_["d"])(this.$el,e);this.mouseX=n.x,this.mouseY=n.y,this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY,this.$store.dispatch("modeling/deselectBlocks"),e.preventDefault&&e.preventDefault()}},handleUp:function(e){console.log("handleUp");var t=e.target||e.srcElement;this.dragging&&(this.dragging=!1,this.hasDragged&&(this.hasDragged=!1)),!this.$el.contains(t)||"string"===typeof t.className&&t.className.includes(this.inputSlotClassName)||(this.linking=!1,this.tempLink=null,this.linkStartData=null)},handleWheel:function(e){var t=e.target||e.srcElement;if(this.$el.contains(t)){var n=Math.pow(1.1,-.01*e.deltaY);if(this.scale*=n,this.scale<this.minScale)return void(this.scale=this.minScale);if(this.scale>this.maxScale)return void(this.scale=this.maxScale);var i={x:this.mouseX,y:this.mouseY},s=(i.x-this.centerX)*(n-1),o=(i.y-this.centerY)*(n-1);this.centerX-=s,this.centerY-=o}},getConnectionPos:function(e,t,n){if(e&&-1!==t){var i=0,s=0;if(i+=e.position[0],s+=e.position[1],n&&e.inputs.length>t)1===e.inputs.length?(i+=this.optionsForChild.width/2,s+=-3):(i+=this.optionsForChild.width/2-10*e.inputs.length/2,i+=20*t);else{if(n||!(e.outputs.length>t))return void console.error("slot "+t+" not found, is input: "+n,e);0===t&&(i+=this.optionsForChild.width/2,s+=45),1===t&&(i+=this.optionsForChild.width,s+=25),2===t&&(s+=25)}return i*=this.scale,s*=this.scale,i+=this.centerX,s+=this.centerY,{x:i,y:s}}},findindexBlock:function(e){return this.blocks.findIndex((function(t){return t.id===e}))},linkingStart:function(e,t){console.log("linkingStart"),this.linkStartData={block:e,slotNumber:t};var n=this.getConnectionPos(this.linkStartData.block,this.linkStartData.slotNumber,!1);this.tempLink={x1:n.x,y1:n.y,x2:this.mouseX,y2:this.mouseY},this.linking=!0},linkingStop:function(e,t){if(console.log("linkingStop"),console.log(e),console.log(this.linkStartData),this.linkStartData.block.id,this.linkStartData&&e&&t>-1){var n=this.linkStartData,i=n.slotNumber,s=n.block.id,o=e.id,a=t;this.links=this.links.filter((function(e){return!(e.targetID===o&&e.targetSlot===a&&e.originID===s&&e.originSlot===i)&&!(e.targetID===s&&e.originID===o||e.originID===s&&e.targetID===o)}));var l=Math.max.apply(Math,[0].concat(Object(r["a"])(this.links.map((function(e){return e.id})))));if(this.linkStartData.block.id!==e.id){var c=this.linkStartData.block.id,u=this.linkStartData.slotNumber,d=e.id,h=t;this.links.push({id:l+1,originID:c,originSlot:u,targetID:d,targetSlot:h}),this.updateModel()}}this.linking=!1,this.tempLink=null,this.linkStartData=null},linkingBreak:function(e,t){if(console.log("linkingBreak"),e&&t>-1){var n=this.links.find((function(n){return n.targetID===e.id&&n.targetSlot===t}));if(n){var i=this.blocks.find((function(e){return e.id===n.originID}));this.links=this.links.filter((function(n){return!(n.targetID===e.id&&n.targetSlot===t)})),e.inputs[n.targetSlot].active=!1,i.outputs[n.originSlot].active=!1,this.linkingStart(i,n.originSlot),this.updateModel()}}},getImages:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y.a.toPng(e.$el,{bgcolor:"#00000000",filter:function(e){return"btn-zoom"!==e.className}});case 3:return n=t.sent,t.abrupt("return",n);case 7:return t.prev=7,t.t0=t["catch"](0),console.log(t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})))()},position:function(e,t){e.position=t},blockSelect:function(e){var t=this;this.$store.dispatch("modeling/deselectBlocks",e),this.$nextTick((function(){t.$store.dispatch("modeling/selectBlock",e)}))},blockDeselect:function(e){e.selected=!1,e&&this.selectedBlock&&this.selectedBlock.id===e.id&&(this.selectedBlock=null),this.$emit("blockDeselect",e)},moveBlock:function(){this.updateModel()},updateModel:function(){this.$store.dispatch("modeling/updateModel")}},mounted:function(){this.$el.addEventListener("mouseenter",this.handleMauseOver),this.$el.addEventListener("mouseleave",this.handleMauseOver),document.documentElement.addEventListener("keyup",this.keyup),document.documentElement.addEventListener("mousemove",this.handleMove,!0),document.documentElement.addEventListener("mousedown",this.handleDown,!0),document.documentElement.addEventListener("mouseup",this.handleUp,!0),document.documentElement.addEventListener("wheel",this.handleWheel,!0),this.centerX=this.$el.clientWidth/2,this.centerY=this.$el.clientHeight/2},beforeDestroy:function(){document.documentElement.removeEventListener("keyup",this.keyup),this.$el.removeEventListener("mouseenter",this.handleMauseOver),this.$el.removeEventListener("mouseleave",this.handleMauseOver),document.documentElement.removeEventListener("mousemove",this.handleMove,!0),document.documentElement.removeEventListener("mousedown",this.handleDown,!0),document.documentElement.removeEventListener("mouseup",this.handleUp,!0),document.documentElement.removeEventListener("wheel",this.handleWheel,!0)}},X=Y,I=(n("a3f2"),Object(m["a"])(X,f,g,!1,null,"58dfa552",null)),N=I.exports,R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"params"},[n("Navbar"),n("scrollbar",[n("div",{staticClass:"params__items"},[n("div",{staticClass:"params__items--item"},[n("Input",{attrs:{label:"Название слоя",type:"text",parse:"name",name:"name",disabled:e.isBlock},on:{change:e.saveModel},model:{value:e.block.name,callback:function(t){e.$set(e.block,"name",t)},expression:"block.name"}}),n("Autocomplete2",{attrs:{value:e.block.typeLabel,list:e.listWithoutOutputInput,label:"Тип слоя",name:"type",disabled:e.isBlock||e.isInput},on:{change:e.changeType}})],1),n("at-collapse",{attrs:{value:e.collapse}},[n("at-collapse-item",{directives:[{name:"show",rawName:"v-show",value:e.main.items.length,expression:"main.items.length"}],staticClass:"mb-3",attrs:{title:"Параметры слоя"}},[n("Forms",{attrs:{data:e.main,id:e.block.id},on:{change:e.change}})],1),n("at-collapse-item",{directives:[{name:"show",rawName:"v-show",value:e.extra.items.length,expression:"extra.items.length"}],staticClass:"mb-3",attrs:{title:"Дополнительные параметры"}},[n("Forms",{attrs:{data:e.extra,id:e.block.id},on:{change:e.change}})],1),n("at-collapse-item",{directives:[{name:"show",rawName:"v-show",value:!e.isBlock,expression:"!isBlock"}],staticClass:"mb-3",attrs:{title:"Размерность слоя",notChange:""}},[e.block.shape&&e.block.shape.input?n("Shape",{attrs:{label:"Размерность входных данных",name:"shape_input",disabled:"Input"!==e.block.type||!!e.project.dataset},on:{change:e.saveModel},model:{value:e.block.shape.input,callback:function(t){e.$set(e.block.shape,"input",t)},expression:"block.shape.input"}}):e._e(),e.block.shape&&e.block.shape.output?n("Shape",{attrs:{value:e.block.shape.output,label:"Размерность выходных данных",name:"shape_output",disabled:!0}}):e._e()],1)],1)],1)])],1)},P=[],T=(n("b64b"),n("b0c0"),n("7d6e")),A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"params__navbar"},[n("ul",{staticClass:"params__navbar--items"},[e._l(e.items,(function(t,i){var s=t.title,o=t.active;return[n("li",{key:"item_"+i,class:["params__navbar--item",{active:o}],attrs:{title:s},on:{click:function(t){return e.click(i)}}},[e._v(" "+e._s(s)+" ")])]}))],2)])},z=[],F={name:"PNavbar",props:{list:{type:Array,default:function(){return[{title:"Слой",active:!0}]}}},data:function(){return{items:[]}},methods:{click:function(e){this.items=this.items.map((function(t,n){return t.active=e===n,t}))}},created:function(){this.items=this.list}},W=F,V=(n("4d8f"),Object(m["a"])(W,A,z,!1,null,"307b0c36",null)),H=V.exports,U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["t-field",{"t-inline":e.inline}]},[n("label",{staticClass:"t-field__label",on:{click:function(t){e.$el.getElementsByTagName("input")[0].focus()}}},[e._v(e._s(e.label))]),"checkbox"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],staticClass:"t-field__input",attrs:{name:e.parse,autocomplete:"off",disabled:e.disabled,type:"checkbox"},domProps:{value:e.value,checked:Array.isArray(e.input)?e._i(e.input,e.value)>-1:e.input},on:{blur:e.change,change:function(t){var n=e.input,i=t.target,s=!!i.checked;if(Array.isArray(n)){var o=e.value,a=e._i(n,o);i.checked?a<0&&(e.input=n.concat([o])):a>-1&&(e.input=n.slice(0,a).concat(n.slice(a+1)))}else e.input=s}}}):"radio"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],staticClass:"t-field__input",attrs:{name:e.parse,autocomplete:"off",disabled:e.disabled,type:"radio"},domProps:{value:e.value,checked:e._q(e.input,e.value)},on:{blur:e.change,change:function(t){e.input=e.value}}}):n("input",{directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],staticClass:"t-field__input",attrs:{name:e.parse,autocomplete:"off",disabled:e.disabled,type:e.type},domProps:{value:e.value,value:e.input},on:{blur:e.change,input:function(t){t.target.composing||(e.input=t.target.value)}}})])},K=[],q=(n("ac1f"),n("1276"),{name:"t-tuple",props:{label:{type:String,default:"Label"},type:{type:String,default:"text"},value:{type:[Array]},parse:String,name:String,inline:Boolean,disabled:Boolean},data:function(){return{isChange:!1}},computed:{input:{set:function(e){this.$emit("input",e?[e.split(",")]:[]),this.isChange=!0},get:function(){return this.value.join()}}},methods:{change:function(e){if(this.isChange){var t=e.target.value;t="number"===this.type?+t:t,this.$emit("change",{name:this.name,value:t?[t.split(",")]:[]}),this.isChange=!1}}}}),J=q,G=(n("3188"),Object(m["a"])(J,U,K,!1,null,"497b61eb",null)),Q=G.exports,Z=n("6522"),ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-inline-label"},[e._l(e.items,(function(t,i){var s=t.type,o=t.value,a=t.list,l=t.event,r=t.label,c=t.parse,u=t.name;return["text_array"===s?n("Tuple",{key:e.blockType+i,attrs:{value:e.getValue(e.valueDef[u],o),label:r,type:"text",parse:c,name:u,inline:""},on:{change:e.change}}):e._e(),"number"===s||"text"===s?n("Input",{key:e.blockType+i,attrs:{value:e.getValue(e.valueDef[u],o),label:r,type:s,parse:c,name:u,error:e.getError(c),inline:""},on:{change:e.change}}):e._e(),"checkbox"===s?n("t-checkbox",{key:e.blockType+i,attrs:{inline:"",value:e.getValue(e.valueDef[u],o),label:r,type:"checkbox",parse:c,name:u,event:l},on:{change:e.change}}):e._e(),"select"===s?n("Select",{key:e.blockType+i,attrs:{value:e.getValue(e.valueDef[u],o),label:r,lists:a,parse:c,name:u},on:{change:e.change}}):e._e()]}))],2)},te=[],ne=n("53ca"),ie=(n("5319"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["t-field",{"t-inline":e.inline}]},[n("label",{staticClass:"t-field__label",on:{click:function(t){e.$el.getElementsByTagName("input")[0].focus()}}},[e._v(e._s(e.label))]),"checkbox"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],staticClass:"t-field__input",attrs:{name:e.parse,autocomplete:"off",disabled:e.disabled,type:"checkbox"},domProps:{value:e.value,checked:Array.isArray(e.input)?e._i(e.input,e.value)>-1:e.input},on:{blur:e.change,change:function(t){var n=e.input,i=t.target,s=!!i.checked;if(Array.isArray(n)){var o=e.value,a=e._i(n,o);i.checked?a<0&&(e.input=n.concat([o])):a>-1&&(e.input=n.slice(0,a).concat(n.slice(a+1)))}else e.input=s}}}):"radio"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],staticClass:"t-field__input",attrs:{name:e.parse,autocomplete:"off",disabled:e.disabled,type:"radio"},domProps:{value:e.value,checked:e._q(e.input,e.value)},on:{blur:e.change,change:function(t){e.input=e.value}}}):n("input",{directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],staticClass:"t-field__input",attrs:{name:e.parse,autocomplete:"off",disabled:e.disabled,type:e.type},domProps:{value:e.value,value:e.input},on:{blur:e.change,input:function(t){t.target.composing||(e.input=t.target.value)}}})])}),se=[],oe=(n("498a"),{name:"t-tuple",props:{label:{type:String,default:"Label"},type:{type:String,default:"text"},value:{type:Array,default:function(){return[]}},parse:String,name:String,inline:Boolean,disabled:Boolean},data:function(){return{isChange:!1}},computed:{input:{set:function(e){this.$emit("input",e.trim()),this.isChange=!0},get:function(){return this.value?this.value.join():""}}},methods:{change:function(e){if(this.isChange){var t=e.target.value.trim();this.$emit("change",{name:this.name,value:t.length?t.split(","):null}),this.isChange=!1}}}}),ae=oe,le=(n("2d4c"),Object(m["a"])(ae,ie,se,!1,null,"1691aac8",null)),re=le.exports,ce=n("7b8d"),ue={name:"Forms",components:{Input:T["a"],Select:ce["a"],Tuple:re},props:{data:{type:Object,default:function(){return{type:"main",items:[],value:{}}}},id:Number},computed:{errors:function(){return this.$store.getters["modeling/getErrorsFields"]||{}},items:function(){var e;return(null===(e=this.data)||void 0===e?void 0:e.items)||[]},valueDef:function(){var e;return(null===(e=this.data)||void 0===e?void 0:e.value)||{}},type:function(){var e;return(null===(e=this.data)||void 0===e?void 0:e.type)||""},blockType:function(){var e;return(null===(e=this.data)||void 0===e?void 0:e.blockType)||""}},methods:{getError:function(e){var t,n;if(this.id){var i=e.replace("parameters","[".concat(this.id,"][parameters]"));return(null===(t=this.errors)||void 0===t||null===(n=t[i])||void 0===n?void 0:n[0])||""}},change:function(e){this.$emit("change",Object(c["a"])({type:this.type},e))},getValue:function(e,t){var n=null!==e&&void 0!==e?e:t;return n}},filters:{toString:function(e){return"object"===Object(ne["a"])(e)?e.join():e},isCheck:function(e){return!!e}}},de=ue,he=Object(m["a"])(de,ee,te,!1,null,null,null),me=he.exports,pe={name:"Params",components:{Shape:Q,Autocomplete2:Z["a"],Forms:me,Navbar:H,Input:T["a"]},data:function(){return{collapse:["0","2"],oldBlock:null}},computed:Object(c["a"])(Object(c["a"])({},Object(u["b"])({list:"modeling/getList",layers:"modeling/getLayersType",buttons:"modeling/getButtons",block:"modeling/getBlock",project:"projects/getProject"})),{},{isBlock:function(){return!this.block.id},isInput:function(){return"input"===this.block.group},listWithoutOutputInput:function(){return this.list.filter((function(e){return!("input"===e.value.toLowerCase())}))},buttonSave:function(){var e;return(null===(e=this.buttons)||void 0===e?void 0:e.save)||!1},main:function(){var e,t=null===(e=this.block)||void 0===e?void 0:e.type;if(Object.keys(this.layers).length&&t){var n,i,s,o=(null===(n=this.layers[t])||void 0===n?void 0:n.main)||[],a=(null===(i=this.block)||void 0===i||null===(s=i.parameters)||void 0===s?void 0:s.main)||{};return{type:"main",items:o,value:a,blockType:t}}return{type:"main",items:[],value:{}}},extra:function(){var e,t=null===(e=this.block)||void 0===e?void 0:e.type;if(Object.keys(this.layers).length&&t){var n,i,s,o=(null===(n=this.layers[t])||void 0===n?void 0:n.extra)||[],a=(null===(i=this.block)||void 0===i||null===(s=i.parameters)||void 0===s?void 0:s.extra)||{};return{type:"extra",items:o,value:a,blockType:t}}return{type:"extra",items:[],value:{}}}}),methods:{saveModel:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("modeling/updateModel",e.block);case 2:case"end":return t.stop()}}),t)})))()},changeType:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=e.value,n.next=3,t.$store.dispatch("modeling/typeBlock",{type:i,block:t.block});case 3:case"end":return n.stop()}}),n)})))()},change:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var i,s,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:i=e.type,s=e.name,o=e.value,console.group(),console.log({type:i,name:s,value:o}),console.log(t.collapse),console.groupEnd(),t.block.parameters?t.block.parameters[i][s]=o:t.oldBlock.parameters[i][s]=o,t.$emit("change"),t.saveModel();case 8:case"end":return n.stop()}}),n)})))()}},watch:{block:{handler:function(e,t){this.oldBlock=t,console.log(e,t)}}}},ve=pe,fe=(n("616b"),Object(m["a"])(ve,R,P,!1,null,"1b0c5fbe",null)),ge=fe.exports,ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("at-modal",{attrs:{width:"680",showClose:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("div",{staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[n("span",[e._v("Загрузка модели")])]),n("div",{staticClass:"row at-row"},[n("div",{staticClass:"col-16 models-list scroll-area"},[n("scrollbar",[n("ul",{staticClass:"loaded-list"},[e._l(e.preset,(function(t,i){return n("li",{key:"preset_"+i,class:["loaded-list__item",{"loaded-list__item--active":e.selected===t.label}],on:{click:function(n){e.getModel(t),e.selected=t.label}}},[n("i",{staticClass:"loaded-list__item--icon"}),n("span",{staticClass:"loaded-list__item--text"},[e._v(e._s(t.label))])])})),e._l(e.custom,(function(t,i){return n("li",{key:"custom_"+i,class:["loaded-list__item",{"loaded-list__item--active":e.selected===t.label}],on:{click:function(n){e.getModel(t),e.selected=t.label}}},[n("i",{staticClass:"loaded-list__item--icon"}),n("span",{staticClass:"loaded-list__item--text"},[e._v(e._s(t.label))]),n("div",{staticClass:"loaded-list__item--empty"}),n("div",{staticClass:"loaded-list__item--remove",on:{click:function(n){return e.removeModel(t.value)}}},[n("i")])])}))],2)])],1),n("div",{staticClass:"col-8"},[e.info.name?n("div",{staticClass:"model-arch"},[n("div",{staticClass:"wrapper hidden"},[n("div",{staticClass:"modal-arch-info"},[n("div",{staticClass:"model-arch-info-param name"},[n("span",[e._v("Name:")]),n("span",[e._v(e._s(e.info.alias?" "+e.info.name:""))])]),n("div",{staticClass:"model-arch-info-param input_shape"},[n("span",[e._v("Input shape:")]),n("span",[e._v(e._s(e.info.input_shape?" ["+e.info.input_shape+"]":""))])])]),e.info.image?n("div",{staticClass:"model-arch__img my-5"},[n("img",{attrs:{alt:"",width:"100",height:"200",src:"data:image/png;base64,"+e.info.image||!1}})]):e._e(),e.info.image?e._e():n("div",{staticClass:"model-arch__empty"},[n("span",[e._v("Нет картинки")])]),n("div",{staticClass:"model-arch__btn"},[n("t-button",{attrs:{disabled:!e.model},on:{click:e.download}},[e._v("Загрузить")])],1)])]):e._e()])]),n("div",{attrs:{slot:"footer"},slot:"footer"})])},be=[],ye={name:"ModalLoadModel",props:{value:Boolean},data:function(){return{lists:[],info:{},model:null,selected:""}},mounted:function(){console.log(this.$el.getElementsByClassName("at-modal__footer")[0].remove())},computed:Object(c["a"])(Object(c["a"])({},Object(u["b"])({})),{},{preset:function(){var e;return(null===(e=this.lists[0])||void 0===e?void 0:e.models)||[]},custom:function(){var e;return(null===(e=this.lists[1])||void 0===e?void 0:e.models)||[]},dialog:{set:function(e){this.$emit("input",e)},get:function(){return this.value}}}),methods:{removeModel:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.$Modal.confirm({title:"Внимание!",content:"Уверены, что хотите удалить эту модель?",width:300,callback:function(){var n=Object(o["a"])(regeneratorRuntime.mark((function n(i){var s,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if("confirm"!=i){n.next=6;break}return n.next=3,t.$store.dispatch("modeling/removeModel",{path:e});case 3:s=n.sent,o=s.success,o&&(t.load(),t.selected="",t.info={});case 6:case"end":return n.stop()}}),n)})));function i(e){return n.apply(this,arguments)}return i}()});case 1:case"end":return n.stop()}}),n)})))()},load:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("modeling/info",{});case 2:n=t.sent,i=n.data,i&&(e.lists=i);case 5:case"end":return t.stop()}}),t)})))()},getModel:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var i,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$store.dispatch("modeling/getModel",e);case 2:i=n.sent,s=i.data,s&&(t.info=s,t.model=e);case 5:case"end":return n.stop()}}),n)})))()},download:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("modeling/load",e.model);case 2:e.$emit("input",!1);case 3:case"end":return t.stop()}}),t)})))()}},watch:{dialog:{handler:function(e){e&&this.load()}}}},_e=ye,xe=(n("5e1d"),Object(m["a"])(_e,ke,be,!1,null,"4b18d262",null)),we=xe.exports,Ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("at-modal",{attrs:{width:"400",showClose:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("div",{staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[n("span",[e._v("Сохранить модель")])]),n("div",{staticClass:"model modal-save-model"},[n("div",{staticClass:"model__image"},[e.image?n("img",{attrs:{alt:"",width:"auto",height:"auto",src:"data:image/png;base64,"+e.image||!1}}):n("Loading",{staticClass:"model__image--loading"})],1),n("div",{staticClass:"model__config"},[n("t-input",{key:"name-key",attrs:{value:e.name,label:"Название модели",type:"text",parse:"parse",name:"name",error:e.err},on:{change:function(t){e.name=t.value}}}),n("t-checkbox",{key:"overwrite",attrs:{inline:"",value:e.overwrite,label:"Перезаписать",type:"checkbox",parse:"test",name:"overwrite"},on:{change:function(t){e.overwrite=t.value}}})],1)]),n("template",{slot:"footer"},[n("t-button",{attrs:{disabled:!e.image},nativeOn:{click:function(t){return e.save.apply(null,arguments)}}},[e._v("Сохранить")]),n("t-button",{attrs:{cancel:""},nativeOn:{click:function(t){return e.close.apply(null,arguments)}}},[e._v("Отменить")])],1)],2)},Me=[],Se=n("8f6b"),$e={name:"ModalSaveModel",components:{Loading:Se["a"]},props:{value:Boolean,image:String},data:function(){return{name:"",overwrite:!1,err:""}},computed:{dialog:{set:function(e){this.$emit("input",e)},get:function(){return this.value}}},methods:{change:function(e){console.log(e)},save:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.image){t.next=21;break}return e.err=null,t.next=4,e.$store.dispatch("modeling/createModel",{name:e.name,preview:e.image,overwrite:e.overwrite});case 4:if(i=t.sent,console.log(i),null===i||void 0===i||!i.error||null===i||void 0===i||null===(n=i.error)||void 0===n||!n.general){t.next=12;break}return t.next=9,e.$store.dispatch("messages/setMessage",{error:"Moдель '".concat(e.name,"' уже создана")},{root:!0});case 9:e.err="Moдель '".concat(e.name,"' уже создана"),t.next=16;break;case 12:if(null===i||void 0===i||!i.error){t.next=16;break}return t.next=15,e.$store.dispatch("messages/setMessage",{error:"Поле не может быть пустым"},{root:!0});case 15:e.err="Поле не может быть пустым";case 16:if(console.log("this.err ".concat(e.err)),e.err){t.next=21;break}return e.dialog=!1,t.next=21,e.$store.dispatch("messages/setMessage",{message:"Moдель '".concat(e.name,"' сохранена")},{root:!0});case 21:case"end":return t.stop()}}),t)})))()},close:function(){this.dialog=!1}},watch:{dialog:{handler:function(e){e&&console.log(this.refs)}}}},je=$e,Oe=(n("26f1"),Object(m["a"])(je,Ce,Me,!1,null,"220a5dac",null)),Ee=Oe.exports,De=n("0ba0"),Le={name:"Modeling",components:{Toolbar:v,Blocks:N,Params:ge,LoadModel:we,SaveModel:Ee,CopyModal:De["a"]},data:function(){return{dialogLoadModel:!1,dialogSaveModel:!1,imageModel:null,kerasModal:!1}},computed:{keras:function(){var e;return(null===(e=this.$store.getters["modeling/getModel"])||void 0===e?void 0:e.keras)||""}},methods:{addBlock:function(e){var t=this.$refs.container.getCenter();this.create=!1,this.$store.dispatch("modeling/addBlock",{type:e,position:t})},saveModel:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,i,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.imageModel=null,e.dialogSaveModel=!0,t.next=4,e.$refs.container.getImages();case 4:return n=t.sent,t.next=7,e.$store.dispatch("modeling/getImageModel",n.slice(22));case 7:i=t.sent,s=i.data,o=void 0===s?null:s,o&&(e.imageModel=o);case 11:case"end":return t.stop()}}),t)})))()},validateModel:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("modeling/validateModel",{});case 2:case"end":return t.stop()}}),t)})))()},clearModel:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$Modal.confirm({title:"Внимание!",content:"Очистить модель?",width:300});case 3:n=t.sent,"confirm"==n&&(console.log("DELETE MODEL"),e.$store.dispatch("modeling/clearModel")),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},actions:function(e){"load"===e&&(this.dialogLoadModel=!0),"input"!==e&&"middle"!==e&&"output"!==e||this.addBlock(e),"save"===e&&(this.saveModel(),this.$store.dispatch("modeling/selectBlock",{})),"validation"===e&&this.validateModel(),"clear"===e&&this.clearModel(),"keras"===e&&(this.kerasModal=!0),console.log(e)}}},Be=Le,Ye=(n("e6fd"),Object(m["a"])(Be,i,s,!1,null,"5c654668",null));t["default"]=Ye.exports},e546:function(e,t,n){},e6fd:function(e,t,n){"use strict";n("becc")}}]);