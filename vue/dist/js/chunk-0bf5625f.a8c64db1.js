(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0bf5625f"],{"0380":function(e,t,n){},"1ab2":function(e,t,n){},"4ef2":function(e,t,n){"use strict";n("caad"),n("2532"),n("b0c0");var s=n("eb4c");t["a"]={props:{disabled:[Boolean,Array],name:String,small:Boolean,error:String,icon:String},computed:{isDisabled:function(){return Array.isArray(this.disabled)?!!this.disabled.includes(this.name):this.disabled}},data:function(){return{debounce:null}},methods:{label:function(){this.$el.children[0].focus()}},created:function(){var e,t;this.debounce=Object(s["a"])(this.change,300),"t-field"===(null===(e=this.$parent)||void 0===e||null===(t=e.$options)||void 0===t?void 0:t._componentTag)&&(this.$parent.error=this.error)},watch:{error:function(e){var t,n,s,r;console.log(null===(t=this.$parent)||void 0===t||null===(n=t.$options)||void 0===n?void 0:n._componentTag),"t-field"===(null===(s=this.$parent)||void 0===s||null===(r=s.$options)||void 0===r?void 0:r._componentTag)&&(this.$parent.error=e)}}}},"5bc3":function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",{staticClass:"page-servers"},[n("scrollbar",{staticClass:"page-servers__scroll",on:{"handle-scroll":e.handleScroll}},[n("span",{staticClass:"page-servers__btn",style:{left:e.scrollLeft+"px",top:e.scrollTop+"px"},on:{click:function(t){e.addNew=!0}}},[n("i",{staticClass:"ci-icon ci-plus_circle"}),n("span",[e._v("Добавить сервер")])]),n("div",{staticClass:"page-servers__list"},[n("LoadSpiner",{directives:[{name:"show",rawName:"v-show",value:e.fetchingServers,expression:"fetchingServers"}],attrs:{text:"Получение списка серверов"}}),n("ServerTable",{directives:[{name:"show",rawName:"v-show",value:e.showTable&&!e.fetchingServers,expression:"showTable && !fetchingServers"}],attrs:{servers:e.servers},on:{instruction:e.openInstruction}}),n("p",{directives:[{name:"show",rawName:"v-show",value:!e.showTable&&!e.fetchingServers,expression:"!showTable && !fetchingServers"}],staticClass:"page-servers__noserver"},[e._v("Нет добавленных серверов демо-панелий")])],1)]),n("div",{staticClass:"page-servers__new"},[e.addNew?n("NewServer",{on:{addServer:e.newServer}}):e._e()],1),n("at-modal",{staticClass:"modal",attrs:{okText:"Читать инструкцию"},on:{"on-confirm":function(t){return e.openInstruction(e.serverID)}},scopedSlots:e._u([{key:"header",fn:function(){return[n("span",{staticClass:"modal-title"},[e._v("Сервер демо-панели добавлен")])]},proxy:!0}]),model:{value:e.serverModal,callback:function(t){e.serverModal=t},expression:"serverModal"}},[n("p",[e._v("Ознакомьтесь с дальнейшими действиями в "),n("span",{staticClass:"clickable",on:{click:function(t){return e.openInstruction(e.serverID)}}},[e._v("Инструкции")])]),n("p",[e._v("Вы также сможете найти ее в таблице серверов на владке Серверы демо-панелей в вашем Профиле")])]),n("at-modal",{staticClass:"modal",attrs:{showConfirmButton:!1,showCancelButton:!1,width:600},on:{"on-cancel":function(t){e.buffer=""}},scopedSlots:e._u([{key:"header",fn:function(){return[n("span",{staticClass:"modal-title"},[e._v("Инструкция по настройке сервера демо-панели")])]},proxy:!0}]),model:{value:e.InstructionModal,callback:function(t){e.InstructionModal=t},expression:"InstructionModal"}},[n("div",{class:["server-state",""+e.selectedServer.state.name]},[e._v(e._s(e.selectedServer.state.value))]),n("div",{staticClass:"server-info"},e._l(e.selectedServer.info,(function(t,s){return n("div",{key:s,staticClass:"server-info__item"},[n("p",{staticClass:"label"},[e._v(e._s(s))]),n("p",{staticClass:"value"},[e._v(e._s(t))])])})),0),n("div",{staticClass:"ssh-wrapper"},[n("div",{staticClass:"ssh-wrapper__item"},[n("span",{staticClass:"ssh"},[e._v("Приватный SSH-ключ")]),n("i",{staticClass:"btn-copy",attrs:{title:"Скопировать"},on:{click:function(t){return e.copy("private")}}}),n("a",{staticClass:"clickable",attrs:{href:e.privateURI,download:"id_rsa"}},[e._v("Скачать")]),n("span",{directives:[{name:"show",rawName:"v-show",value:"private"===e.buffer,expression:"buffer === 'private'"}],staticClass:"buffer"},[e._v("Ключ скопирован в буффер обмена")])]),n("div",{staticClass:"ssh-wrapper__item"},[n("span",{staticClass:"ssh"},[e._v("Публичный SSH-ключ")]),n("i",{staticClass:"btn-copy",attrs:{title:"Скопировать"},on:{click:function(t){return e.copy("public")}}}),n("a",{staticClass:"clickable",attrs:{href:e.publicURI,download:"id_rsa.pub"}},[e._v("Скачать")]),n("span",{directives:[{name:"show",rawName:"v-show",value:"public"===e.buffer,expression:"buffer === 'public'"}],staticClass:"buffer"},[e._v("Ключ скопирован в буффер обмена")])])]),n("hr"),n("div",{staticClass:"instruction",domProps:{innerHTML:e._s(e.instruction)}})])],1)},r=[],i=n("1da1"),a=n("5530"),o=(n("96cf"),n("b64b"),n("7db0"),n("d3b7"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("table",{staticClass:"server-table"},[e._m(0),n("tbody",e._l(e.servers,(function(t){return n("tr",{key:t.id},[n("td",[e._v(e._s(t.domain_name))]),n("td",[e._v(e._s(t.ip_address))]),n("td",[e._v(e._s(t.user))]),n("td",[e._v(e._s(t.port_ssh))]),n("td",[e._v(e._s(t.port_http))]),n("td",[e._v(e._s(t.port_https))]),n("td",{staticClass:"clickable"},[n("span",{on:{click:function(n){return e.instruction(t.id)}}},[e._v("Открыть")])]),n("td",{class:[""+t.state.name]},[e._v(e._s(t.state.value))]),n("td",{staticClass:"clickable",on:{click:function(n){return e.setup(t.id)}}},[n("i",{class:["ci-icon",e.getIcon(t.state.name)]}),n("span",[e._v(e._s(e.getAction(t.state.name)))])])])})),0)])}),c=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("thead",[n("tr",[n("th",[e._v("Доменное имя")]),n("th",[e._v("IP адрес")]),n("th",[e._v("Имя пользователя")]),n("th",[e._v("SSH порт")]),n("th",[e._v("HTTP порт")]),n("th",[e._v("HTTPS порт")]),n("th",[e._v("Инструкция")]),n("th",[e._v("Состояние")]),n("th",{staticStyle:{"min-width":"144px"}})])])}],l={name:"ServerTable",props:{servers:[Array,Object]},methods:{instruction:function(e){this.$emit("instruction",e)},setup:function(e){this.$store.dispatch("servers/setup",{id:e})},getIcon:function(e){return"ready"===e||"waiting"===e?"":"ci-play_arrow"},getAction:function(e){return"ready"===e||"waiting"===e?"":"Установить"}}},u=l,p=(n("c2e3"),n("2877")),d=Object(p["a"])(u,o,c,!1,null,"82fd844e",null),h=d.exports,v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"new-server"},[n("p",{staticClass:"new-server__header"},[e._v("Добавление сервера демо-панели")]),n("form",{staticClass:"new-server__form",on:{submit:function(t){return t.preventDefault(),e.addServer.apply(null,arguments)}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"new-server__form--overlay"}),n("t-field",{attrs:{label:"Доменное имя"}},[n("t-input-new",{attrs:{placeholder:""},model:{value:e.domain_name,callback:function(t){e.domain_name=t},expression:"domain_name"}})],1),n("t-field",{attrs:{label:"IP адрес"}},[n("VueIP",{attrs:{ip:e.ip_address,onChange:e.change}})],1),n("t-field",{attrs:{label:"Имя пользователя"}},[n("t-input-new",{attrs:{placeholder:""},model:{value:e.user,callback:function(t){e.user=t},expression:"user"}})],1),n("div",{staticClass:"new-server__ports"},[n("t-field",{attrs:{label:"SSH порт"}},[n("DInputNumber",{attrs:{placeholder:""},model:{value:e.port_ssh,callback:function(t){e.port_ssh=t},expression:"port_ssh"}})],1),n("t-field",{attrs:{label:"HTTP порт"}},[n("DInputNumber",{attrs:{placeholder:""},model:{value:e.port_http,callback:function(t){e.port_http=t},expression:"port_http"}})],1),n("t-field",{attrs:{label:"HTTPS порт"}},[n("DInputNumber",{attrs:{placeholder:""},model:{value:e.port_https,callback:function(t){e.port_https=t},expression:"port_https"}})],1)],1),n("t-button",{staticClass:"new-server__btn",attrs:{disabled:!e.validForm||e.loading}},[e._v("Добавить")])],1),n("LoadSpiner",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{text:""}})],1)},f=[],m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"vue-ip",class:{"show-port":!1!==e.portCopy,"material-theme":"material"===e.theme,active:e.active,valid:e.valid}},e._l(e.ipCopy,(function(t,s){return n("div",{key:s,staticClass:"segment"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.ipCopy[s],expression:"ipCopy[index]"}],ref:"ipSegment",refInFor:!0,attrs:{type:"number",placeholder:"___",maxlength:"3"},domProps:{value:e.ipCopy[s]},on:{paste:function(t){return e.paste(t)},keydown:function(t){return e.ipKeydown(t,s)},focus:function(t){return e.ipFocus(s)},blur:e.blur,input:[function(t){t.target.composing||e.$set(e.ipCopy,s,t.target.value)},e.input]}})])})),0)},_=[],b=(n("a9e3"),n("ac1f"),n("1276"),n("d81d"),n("a15b"),n("00b4"),{props:{onChange:Function,ip:{required:!0,type:String},port:{type:[String,Number,Boolean],default:!1},placeholder:{type:[Boolean],default:!1},theme:{type:[String,Boolean],default:!1}},data:function(){return{ipCopy:["","","",""],portCopy:null,valid:!1,active:!1}},beforeMount:function(){this.copyValue(this.ip,this.port)},watch:{ip:function(e){this.copyValue(e,this.port)},port:function(e){this.copyValue(this.ip,e)}},methods:{input:function(e){e.target.value||(e.target.value="")},placeholderPos:function(e){if(!this.placeholder)return"";switch(e){case 0:return"192";case 1:return"168";case 2:return"0";case 3:return"1"}},ipFocus:function(e){this.active=!0,this.ipCopy[e]="",this.changed()},clearAll:function(){this.ipCopy=["","","",""],this.portCopy=null,this.valid=!1},blur:function(){this.active=!1},portFocus:function(){this.active=!0,this.portCopy=null,this.changed()},paste:function(e){this.$refs.ipSegment[0].focus();var t=e.clipboardData.getData("text/plain"),n=t.indexOf(":");if(!1===this.port){console.warn("A IP address with a port has been entered but this module has no port attribute. Please enable it update the port."),this.clearAll();var s=t.split(":");return this.copyValue(s[0],!1),void this.$refs.ipSegment[0].blur()}switch(n){case-1:this.copyValue(t,null),this.changed(),this.$refs.ipSegment[0].blur();break;default:var r=t.split(":");this.copyValue(r[0],r[1]),this.changed(),this.$refs.ipSegment[0].blur();break}},ipKeydown:function(e,t){var n=this,s=e.keyCode||e.which;8!==s&&37!==s||0===this.ipCopy[t].length&&void 0!==this.ipCopy[t-1]&&this.$refs.ipSegment[t-1].focus(),setTimeout((function(){"0"===n.ipCopy[t]?n.moveToNextIpSegment(t,!1):n.moveToNextIpSegment(t),n.changed()}))},moveToNextIpSegment:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t?this.ipCopy[e].length>=3&&void 0!==this.ipCopy[e+1]&&this.$refs.ipSegment[e+1].focus():t||void 0!==this.ipCopy[e+1]&&this.$refs.ipSegment[e+1].focus()},changed:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.ipCopy,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.portCopy,n=this.arrayToIp(e);this.onChange(n,t,this.validateIP(e))},copyValue:function(e,t){e&&this.ipToArray(e),this.portCopy=t,this.valid=this.validateIP(this.ipCopy),this.changed()},ipToArray:function(e){var t=[];e.split(".").map((function(e){(isNaN(e)||e<0||e>255)&&(e=255),t.push(e)})),4!==t.length?(console.error("Not valid, so clearing ip",t),this.clearAll()):this.ipCopy=t},arrayToIp:function(e){return e.join(".")},validateIP:function(e){var t=this.arrayToIp(e);return/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(t)}}}),g=b,y=(n("a34e"),Object(p["a"])(g,m,_,!1,null,"64c5dbba",null)),w=y.exports,C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"d-input",class:[{"d-input--error":e.error},{"d-input--small":e.small},{"d-input--disabled":e.isDisabled}]},[e.icon?n("div",{staticClass:"d-input__icon"},[n("i",{class:"ci-icon ci-"+e.icon})]):e._e(),"checkbox"===e.type?n("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],class:["d-input__input"],attrs:{autocomplete:"off",name:e.name,placeholder:e.placeholder,disabled:e.isDisabled,type:"checkbox"},domProps:{checked:Array.isArray(e.input)?e._i(e.input,null)>-1:e.input},on:{input:e.debounce,focus:e.focus,change:function(t){var n=e.input,s=t.target,r=!!s.checked;if(Array.isArray(n)){var i=null,a=e._i(n,i);s.checked?a<0&&(e.input=n.concat([i])):a>-1&&(e.input=n.slice(0,a).concat(n.slice(a+1)))}else e.input=r}}},"input",e.$attrs,!1)):"radio"===e.type?n("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],class:["d-input__input"],attrs:{autocomplete:"off",name:e.name,placeholder:e.placeholder,disabled:e.isDisabled,type:"radio"},domProps:{checked:e._q(e.input,null)},on:{input:e.debounce,focus:e.focus,change:function(t){e.input=null}}},"input",e.$attrs,!1)):n("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],class:["d-input__input"],attrs:{autocomplete:"off",name:e.name,placeholder:e.placeholder,disabled:e.isDisabled,type:e.type},domProps:{value:e.input},on:{input:[function(t){t.target.composing||(e.input=t.target.value)},e.debounce],focus:e.focus}},"input",e.$attrs,!1)),n("div",{staticClass:"d-input__btn"},["number"===e.type?n("div",{class:["d-input__btn--number",{"d-input__btn--disabled":e.isDisabled}]},[n("i",{staticClass:"ci-icon ci-caret_up",on:{click:function(t){return e.send(e.input+1)}}}),n("i",{staticClass:"ci-icon ci-caret_down",on:{click:function(t){return e.send(e.input-1)}}})]):e._e()])])},S=[],k=(n("b0c0"),n("4ef2")),x={name:"d-input-number",mixins:[k["a"]],props:{type:{type:String,default:"number"},placeholder:{type:String,default:"Введите число"},value:[Number]},data:function(){return{input:""}},computed:{},methods:{clear:function(){this.input="",this.send("")},focus:function(e){this.$emit("focus",e)},change:function(e){var t=e.target;this.send(t.value)},send:function(e){if(e<0)return this.input=0;this.$emit("change",{name:this.name,value:e}),this.$emit("input",+e)}},created:function(){this.input=this.value},watch:{value:function(e){this.input=e}}},I=x,T=(n("ce00"),Object(p["a"])(I,C,S,!1,null,"9be4d8f8",null)),$=T.exports,N=n("1636"),D={name:"NewServer",data:function(){return{ip_address:"",ipValid:null,domain_name:"",user:"",port_ssh:22,port_http:80,port_https:443,loading:!1}},components:{VueIP:w,DInputNumber:$,LoadSpiner:N["default"]},computed:{validForm:function(){return!!(this.ipValid&&this.domain_name&&this.user&&this.port_ssh&&this.port_http&&this.port_https)}},methods:{change:function(e,t,n){this.ip_address=e,this.ipValid=n},addServer:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$store.dispatch("servers/addServer",{domain_name:e.domain_name,ip_address:e.ip_address,user:e.user,port_ssh:e.port_ssh,port_http:e.port_http,port_https:e.port_https});case 3:n=t.sent,s=n.id,e.$emit("addServer",s),e.loading=!1;case 7:case"end":return t.stop()}}),t)})))()}}},P=D,j=(n("6cc9"),Object(p["a"])(P,v,f,!1,null,"0ed88e8e",null)),A=j.exports,O=n("2f62"),R={name:"servers",components:{ServerTable:h,NewServer:A,LoadSpiner:N["default"]},data:function(){return{addNew:!1,serverModal:!1,InstructionModal:!1,serverID:null,private_key:null,public_key:null,instruction:null,fetchingServers:!1,buffer:"",scrollLeft:0,scrollTop:0,intervalID:null}},computed:Object(a["a"])(Object(a["a"])({},Object(O["c"])({servers:"servers/getServers"})),{},{showTable:function(){return!!Object.keys(this.$store.getters["servers/getServers"]).length},getServer:function(){var e=this;return this.servers.find((function(t){return t.id===e.serverID}))},privateURI:function(){return"data:application/octet-stream;charset=utf-8,"+encodeURIComponent(this.private_key)},publicURI:function(){return"data:application/octet-stream;charset=utf-8,"+encodeURIComponent(this.public_key)},selectedServer:function(){var e=this,t=this.$store.getters["servers/getServers"].find((function(t){return t.id===e.serverID}));return t?{info:{"Доменное имя":t.domain_name,"Имя пользователя":t.user,"HTTP порт":t.port_http,"IP адерс":t.ip_address,"SSH порт":t.port_ssh,"HTTPS порт":t.port_https},state:t.state}:{state:""}}}),methods:{copy:function(e){var t="private"===e?this.private_key:this.public_key,n=document.createElement("input");document.body.appendChild(n),n.value=t,n.select(),document.execCommand("copy"),n.remove(),this.buffer=e},newServer:function(e){this.serverID=e,this.addNew=!1,this.serverModal=!0},openInstruction:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var s,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.serverID=e,t.serverModal=!1,t.InstructionModal=!0,n.next=5,t.$store.dispatch("servers/getInstruction",{id:e});case 5:s=n.sent,r=s.data,t.private_key=r.private_ssh_key,t.public_key=r.public_ssh_key,t.instruction=r.instruction;case 10:case"end":return n.stop()}}),n)})))()},handleScroll:function(e,t){this.scrollLeft=t.scrollLeft,this.scrollTop=e.scrollTop}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.fetchingServers=!0,t.next=3,e.$store.dispatch("servers/getServers");case 3:e.intervalID=setInterval(Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("servers/getServers");case 2:case"end":return t.stop()}}),t)}))),6e4),e.fetchingServers=!1,e.$router.afterEach((function(){clearInterval(e.intervalID)}));case 6:case"end":return t.stop()}}),t)})))()}},M=R,H=(n("77c4"),Object(p["a"])(M,s,r,!1,null,"67abe9d5",null));t["default"]=H.exports},"6a3a":function(e,t,n){},"6cc9":function(e,t,n){"use strict";n("b42f")},"77c4":function(e,t,n){"use strict";n("6a3a")},a34e:function(e,t,n){"use strict";n("a5df")},a5df:function(e,t,n){},b42f:function(e,t,n){},c2e3:function(e,t,n){"use strict";n("0380")},ce00:function(e,t,n){"use strict";n("1ab2")},eb4c:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var s=function(e,t,n){var s;return function(){var r=this,i=arguments,a=function(){s=null,n||e.apply(r,i)},o=n&&!s;clearTimeout(s),s=setTimeout(a,t),o&&e.apply(r,i)}}}}]);